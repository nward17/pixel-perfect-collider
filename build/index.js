!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ppc=e():t.ppc=e()}(window,(function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});let s=0,n=[];let o={pixelTestFunction:(t,e,i,s)=>t+e+i>0&&s>0};e.setOptions=function(t){!function(t,e){for(let i in t)e(t[i],i)}(t,(t,e)=>{o[e]=t})};function r(t,e){const i=e%32,s=Math.floor(e/32);return 0===i?u(t,s):u(t,s)<<i>>>0|u(t,s+1)>>>32-i}function u(t,e){return e<0||e>=t.length?0:t[e]}e.Collider=class{constructor(t,e=!0){if(this.pos={x:0,y:0},this.anchor={x:0,y:0},this.size={x:0,y:0},this.pixelBits=[],this.isPositionSet=!1,this.size.x=t.width,this.size.y=t.height,e&&"_ppcCacheIndex"in t)return void(this.pixelBits=n[t._ppcCacheIndex]);let i;if(t.data)i=t.data;else{const e=document.createElement("canvas");e.width=this.size.x,e.height=this.size.y;const s=e.getContext("2d");s.drawImage(t,0,0),i=s.getImageData(0,0,this.size.x,this.size.y).data}let r=0;for(let t=0;t<this.size.y;t++){let t=[],e=0,s=1<<31>>>0;for(let n=0;n<this.size.x;n++)o.pixelTestFunction(i[r],i[r+1],i[r+2],i[r+3])&&(e|=s),s>>>=1,s<=0&&(t.push(e),s=1<<31>>>0,e=0),r+=4;s<1<<31>>>0&&t.push(e),this.pixelBits.push(t)}e&&(n.push(this.pixelBits),t._ppcCacheIndex=s,s++)}setPos(t,e){this.pos.x=Math.floor(t-this.size.x*this.anchor.x),this.pos.y=Math.floor(e-this.size.y*this.anchor.y),this.isPositionSet=!0}setAnchor(t,e){this.anchor.x=t,this.anchor.y=e}test(t){if(!this.isPositionSet||!t.isPositionSet)return!1;const e={x:t.pos.x-this.pos.x,y:t.pos.y-this.pos.y};if(e.x<-t.size.x||e.x>this.size.x||e.y<-t.size.y||e.y>this.size.y)return!1;const i=e.x>0?e.x:0,s=e.x>0?0:-e.x;for(let n=e.y>0?e.y:0,o=e.y>0?0:-e.y;n<this.size.y&&!(o>=t.size.y);n++,o++)for(let e=i,u=s;e<this.size.x&&!(u>=t.size.x);e+=32,u+=32){if((r(this.pixelBits[n],e)&r(t.pixelBits[o],u))>0)return!0}return!1}},e.clearCache=function(){s=0,n=[]}}])}));